/**
* jPList - jQuery Data Grid Controls 0.0.13 - http://jplist.com 
* Copyright 2015 jPList Software
*/
(function(){var h=function(b){b.params={scopeObserver:null,dataSource:null,view:null,autocompleteParams:{dataPath:b.$control.attr("data-path"),ignore:b.$control.attr("data-ignore")||"[~!@#$%^&*()+=`'\"/\\_ ]+",minChars:Number(b.$control.attr("data-minchars"))||0,maxItems:Number(b.$control.attr("data-maxitems"))||5,render:b.$control.attr("data-render"),onSuggest:b.$control.attr("data-onsuggest")}};var g=b.params,c=jQuery({});c.$root=b.$control;c.events={inputValueChanged:"1",DOMDataLoaded:"2",ServerDataLoaded:"3",
onSelect:"4"};g.scopeObserver=c;b.params.dataSource=new jQuery.fn.jplist.ui.controls.AutocompleteDataSource(b.params.scopeObserver,b.$root,b.options,b.params.autocompleteParams);b.params.view=new jQuery.fn.jplist.ui.controls.AutocompleteView(b.$control,b.params.scopeObserver,b.params.autocompleteParams);return jQuery.extend(this,b)};h.prototype.getPaths=function(b){var g=null,g=new jQuery.fn.jplist.domain.dom.models.DataItemMemberPathModel(this.params.autocompleteParams.dataPath,null);b.push(g)};
jQuery.fn.jplist.ui.controls.Autocomplete=function(b){return new h(b)};jQuery.fn.jplist.controlTypes.autocomplete={className:"Autocomplete",options:{}}})();(function(){var h=function(c,b){var f="html",e=[],d,a;jQuery.trim(b)?(c.options.dataSource&&c.options.dataSource.server&&c.options.dataSource.server.ajax&&((f=c.options.dataSource.server.ajax.dataType)||(f="html")),d={action:"filter",type:"autocomplete",data:{path:c.params.dataPath,ignore:c.params.ignore,value:b,minChars:c.params.minChars,maxItems:c.params.maxItems}},a={action:"paging",type:"placeholder",data:{number:c.params.maxItems,currentPage:0}},e.push(d),e.push(a),jQuery.fn.jplist.dal.services.URIService.get(e,
c.options,function(a,l,d,e){a=new jQuery.fn.jplist.domain.server.models.DataItemModel(a,f,e.responseText);c.scopeObserver.trigger(c.scopeObserver.events.ServerDataLoaded,[a,b])},function(a){},function(a){})):c.scopeObserver.trigger(c.scopeObserver.events.ServerDataLoaded,[null,b])},b=function(c){c.scopeObserver.on(c.scopeObserver.events.inputValueChanged,function(b,f){if(c.options&&c.options.dataSource)switch(c.options.dataSource.type){case "html":var e,d=[];e=c.$root.jplist({command:"getDataItems",
commandData:{}});jQuery.trim(f)&&e&&(d=new jQuery.fn.jplist.domain.dom.models.DataItemMemberPathModel(c.params.dataPath,null),(d=jQuery.fn.jplist.domain.dom.services.FiltersService.textFilter(f,d,e,c.params.ignore))&&d.length>c.params.maxItems&&d.splice(c.params.maxItems,d.length-c.params.maxItems));d||(d=[]);c.scopeObserver.trigger(c.scopeObserver.events.DOMDataLoaded,[d]);break;case "server":h(c,f)}})},g=function(c,g,f,e){c={scopeObserver:c,$root:g,options:f,params:e};b(c);return jQuery.extend(this,
c)};jQuery.fn.jplist.ui.controls.AutocompleteDataSource=function(c,b,f,e){return new g(c,b,f,e)}})();(function(){var h=function(a){var c=null;a=a.$placeholder.children();0<a.length&&(c=a.filter(".autocomplete-active"));c&&((a=c.attr("href"))?window.location.href=a:c.trigger("click"))},b=function(a,c){var b,e,d;a.$placeholder.is(":visible")&&(b=a.$placeholder.children(),0<b.length&&(d=-1,b.each(function(a,c){var b=jQuery(c);b.hasClass("autocomplete-active")&&(d=a,e=b)}),b.removeClass("autocomplete-active"),"up"===c?-1!==d&&(0<=d-1?(b=b.eq(d-1),b.addClass("autocomplete-active")):e.addClass("autocomplete-active")):
-1===d?b.eq(0).addClass("autocomplete-active"):d+1<b.length?(b=b.eq(d+1),b.addClass("autocomplete-active")):e.addClass("autocomplete-active")))},g=function(a){jQuery('[data-control-type="autocomplete"] [data-type="placeholder"]').each(function(){var a=jQuery(this);!0===a.data("autocomplete-placeholder")&&a.hide()})},c=function(a){0<(Number(a.$placeholder.attr("data-length"))||0)?a.$placeholder.show(0):g(a)},k=function(a,b,d){var e="";a.$placeholder.empty();jQuery.each(b,function(a,b){e+=b.html});
a.$placeholder.html(e);a.$placeholder.attr("data-length",b.length);c(a);a.$control.removeClass("autocomplete-loading");if(a.params.onSuggest&&jQuery.isFunction(jQuery.fn.jplist.settings[a.params.onSuggest]))jQuery.fn.jplist.settings[a.params.onSuggest](a,b,d)},f=function(a){a.$input.on("keyup",function(c){var d;c.stopPropagation();d=jQuery.trim(jQuery(this).val());switch(c.keyCode){case a.askii.UP:b(a,"up");break;case a.askii.DOWN:b(a,"down");break;case a.askii.ENTER:h(a);break;case a.askii.RETURN:h(a);
break;default:if(d.length>=a.params.minChars||0===d.length)a.$control.addClass("autocomplete-loading"),a.scopeObserver.trigger(a.scopeObserver.events.inputValueChanged,[d])}})},e=function(a){a.scopeObserver.on(a.scopeObserver.events.DOMDataLoaded,function(b,c,d){k(a,c,d)});a.scopeObserver.on(a.scopeObserver.events.ServerDataLoaded,function(b,d,e){b="";d?(b=a.params.render&&jQuery.isFunction(jQuery.fn.jplist.settings[a.params.render])?jQuery.fn.jplist.settings[a.params.render](d):d.content,a.$placeholder.html(b),
a.$placeholder.attr("data-length",d.count)):(a.$placeholder.empty(),a.$placeholder.attr("data-length",0));c(a);a.$control.removeClass("autocomplete-loading");if(a.params.onSuggest&&jQuery.isFunction(jQuery.fn.jplist.settings[a.params.onSuggest]))jQuery.fn.jplist.settings[a.params.onSuggest](a,d,e)});f(a);a.$input.on("click",function(b){b.stopPropagation();g(a);c(a)});jQuery(document).on("click",function(){g(a)});a.$placeholder.on("click",function(a){a.stopPropagation()});a.$btn.on("click",function(b){h(a)})},
d=function(a,b,d){a={$control:a,scopeObserver:b,$input:a.find('input[type="text"]'),$btn:a.find("button"),$actions:null,$placeholder:null,params:d,askii:{LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,RETURN:3}};a.$input.val("");a.$control.wrapInner('<div data-type="actions" class="jplist-autocomplete-actions"></div>');a.$actions=a.$control.find('[data-type="actions"]');0>=a.$input.next('[data-type="placeholder"]').length&&(a.$actions.after('<div class="jplist-autocomplete-placeholder"><div class="autocomplete-box" data-type="placeholder"></div></div>'),
a.$placeholder=a.$control.find('[data-type="placeholder"]:first'));a.$placeholder.data("autocomplete-placeholder",!0);c(a);e(a);return jQuery.extend(this,a)};jQuery.fn.jplist.ui.controls.AutocompleteView=function(a,b,c){return new d(a,b,c)}})();